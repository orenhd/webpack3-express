{"version":3,"sources":["webpack:///webpack/bootstrap b5ffd4af9aa3d4195dd7","webpack:///external \"express\"","webpack:///external \"mongoose\"","webpack:///./src/databases/mongo_db.js","webpack:///./src/main.js","webpack:///external \"socket.io\"","webpack:///external \"body-parser\"","webpack:///./src/routes/router.js","webpack:///./src/routes/user.routes.js","webpack:///./src/controllers/user.controller.js","webpack:///external \"jsonwebtoken\"","webpack:///./src/models/user.model.js","webpack:///external \"bcrypt\"","webpack:///external \"dotenv\"","webpack:///./src/routes/chatbot.routes.js","webpack:///./src/controllers/chatbot.controller.js","webpack:///external \"request\"","webpack:///./src/services/youtube_api.service.js","webpack:///external \"googleapis\""],"names":["config","MEADOWS_COLLECTION","connection","on","ref","console","log","err","connect","process","env","MONGODB_URI","DB_USER","DB_PASS","db","app","use","urlencoded","extended","json","port","PORT","static","__dirname","get","req","res","sendFile","io","listen","socket","doodleData","emit","router","Router","message","user_controller","post","user_signup","user_login","user_verify_token","user_get","AT_STRING","user_temp","username","body","password","save","status","findOne","user","comparePassword","isMatch","token","sign","expiresIn","success","next","query","headers","verify","decoded","send","collection","params","id","doc","handleError","SALT_WORK_FACTOR","userSchema","Schema","type","String","required","index","unique","pre","isModified","genSalt","salt","hash","methods","candidatePassword","cb","compare","UserModel","model","chatbot_controller","VERIFY_TOKEN","webhook","youtube_search","youTubeApiService","object","entry","forEach","messaging","event","processMessage","postback","sender","MY_MICHAL_ID","MY_ID","processMyPostback","sendStatus","senderId","text","formattedMsg","toLowerCase","trim","fetchVideoAndSend","attachments","sendMessage","payload","formattedMessage","recipientId","recipientName","youtubeApiService","searchList","then","response","items","videoData","snippet","title","thumbnails","medium","url","description","videoId","qs","access_token","PAGE_ACCESS_TOKEN","method","recipient","error","searchListRepoonse","urlshortener","youtube","constQuery","queryString","searchListPromise","Promise","resolve","reject","search","list","auth","API_KEY","maxResults","part","q"],"mappings":";;AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAK;AACL;AACA;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;AAEA;AACA;;;;;;;AC7DA,oC;;;;;;ACAA,qC;;;;;;;;;;;;;;ACAA;;;;AACA;;;;;;AAEA,IAAMA,SAAS,iBAAOA,MAAP,EAAf;;AAEA;;AAEO,IAAMC,kDAAqB,SAA3B;;AAEP,mBAASC,UAAT,CAAoBC,EAApB,CAAuB,MAAvB,EAA+B,UAASC,GAAT,EAAc;AAC3CC,UAAQC,GAAR,CAAY,4BAAZ;AACD,CAFD;;AAIA,mBAASJ,UAAT,CAAoBC,EAApB,CAAuB,OAAvB,EAAgC,UAASI,GAAT,EAAc;AAC5CF,UAAQC,GAAR,CAAY,oCAAZ;AACD,CAFD;;AAIA,mBAASE,OAAT,CAAiBC,QAAQC,GAAR,CAAYC,WAAZ,mBAAwCF,QAAQC,GAAR,CAAYE,OAApD,SAA+DH,QAAQC,GAAR,CAAYG,OAA3E,+CAAjB;AACO,IAAMC,kBAAK,mBAASZ,UAApB,C;;;;;;;;;AClBP;;;;AACA;;;;AAEA;;;;AAEA;;;;;;AAEA,IAAMa,MAAM,wBAAZ;;AAEA;AACAA,IAAIC,GAAJ,CAAQ,qBAAWC,UAAX,CAAsB,EAAEC,UAAU,IAAZ,EAAtB,CAAR;AACAH,IAAIC,GAAJ,CAAQ,qBAAWG,IAAX,EAAR;;AAEA,IAAMC,OAAOX,QAAQC,GAAR,CAAYW,IAAZ,IAAoB,IAAjC,C,CAAuC;;AAEvC;AACAN,IAAIC,GAAJ,CAAQ,GAAR,EAAa,kBAAQM,MAAR,CAAeC,YAAY,SAA3B,CAAb;;AAEA;AACAR,IAAIS,GAAJ,CAAQ,eAAR,EAAyB,UAAUC,GAAV,EAAeC,GAAf,EAAoB;AAC3CA,MAAIC,QAAJ,CAAaJ,YAAY,2BAAzB;AACD,CAFD;;AAIA;AACAR,IAAIC,GAAJ,CAAQ,MAAR;;AAEA,IAAMY,KAAK,iBAASC,MAAT,CAAgBd,IAAIc,MAAJ,CAAWT,IAAX,CAAhB,CAAX,C,CAA8C;;AAE9Cf,QAAQC,GAAR,CAAY,2BAA2Bc,IAAvC;;AAEAQ,GAAGzB,EAAH,CAAM,YAAN,EAAoB,UAAC2B,MAAD,EAAY;AAC9BA,SAAO3B,EAAP,CAAU,QAAV,EAAoB,UAAC4B,UAAD,EAAgB;AAClCH,OAAGI,IAAH,CAAQ,SAAR,EAAmBD,UAAnB;AACD,GAFD;AAGD,CAJD,E;;;;;;AC9BA,sC;;;;;;ACAA,wC;;;;;;;;;;;;;ACAA;;;;AAGA;;;;AACA;;;;;;AAFA;AAIA,IAAME,SAAS,kBAAQC,MAAR,EAAf;;AAEA;AACAD,OAAOT,GAAP,CAAW,GAAX,EAAgB,UAASC,GAAT,EAAcC,GAAd,EAAmB;AAC/BA,QAAIP,IAAJ,CAAS,EAAEgB,SAAS,6BAAX,EAAT;AACH,CAFD;;AAIA;AACAF,OAAOjB,GAAP,CAAW,OAAX;AACAiB,OAAOjB,GAAP,CAAW,UAAX;;kBAEeiB,M;;;;;;;;;;;;;ACjBf;;;;AAEA;;IAAYG,e;;;;;;AAEZ,IAAMH,SAAS,kBAAQC,MAAR,EAAf;;AAEA;;AAEAD,OAAOI,IAAP,CAAY,SAAZ,EAAuBD,gBAAgBE,WAAvC;;AAEAL,OAAOI,IAAP,CAAY,QAAZ,EAAsBD,gBAAgBG,UAAtC;;AAEA;AACAN,OAAOjB,GAAP,CAAWoB,gBAAgBI,iBAA3B;;AAEAP,OAAOT,GAAP,CAAW,MAAX,EAAmBY,gBAAgBK,QAAnC;;kBAEeR,M;;;;;;;;;;;;;;ACjBf;;;;AAEA;;AAEA;;;;AAEA,IAAMS,YAAY,iBAAlB;;AAEO,IAAMJ,oCAAc,SAAdA,WAAc,CAACb,GAAD,EAAMC,GAAN,EAAc;AACxC,KAAIiB,YAAY,oBAAc;AAC7BC,YAAUnB,IAAIoB,IAAJ,CAASD,QADU;AAE7BE,YAAUrB,IAAIoB,IAAJ,CAASC;AAFU,EAAd,CAAhB;;AAKAH,WAAUI,IAAV,CAAe,UAACxC,GAAD,EAAS;AACvB,MAAIA,GAAJ,EAAS;AAAE,SAAMA,GAAN;AAAY;AACvBmB,MAAIsB,MAAJ,CAAW,GAAX,EAAgB7B,IAAhB,CAAqB,EAArB;AACE,EAHH;AAIA,CAVM;;AAYA,IAAMoB,kCAAa,SAAbA,UAAa,CAACd,GAAD,EAAMC,GAAN,EAAc;AACvC,iBAAUuB,OAAV,CAAkB,EAAEL,UAAUnB,IAAIoB,IAAJ,CAASD,QAArB,EAAlB,EAAmD,UAACrC,GAAD,EAAM2C,IAAN,EAAe;AACjE,MAAI3C,GAAJ,EAAS,MAAMA,GAAN;;AAET,MAAI2C,IAAJ,EAAU;AACT;AACAA,QAAKC,eAAL,CAAqB1B,IAAIoB,IAAJ,CAASC,QAA9B,EAAwC,UAACvC,GAAD,EAAM6C,OAAN,EAAkB;AACzD,QAAI7C,GAAJ,EAAS,MAAMA,GAAN;AACT,QAAI6C,OAAJ,EAAa;AACZ;AACA,SAAIC,QAAQ,uBAAIC,IAAJ,CAASJ,IAAT,EAAeR,SAAf,EAA0B;AACpCa,iBAAW;AADyB,MAA1B,CAAZ;;AAIA;AACA7B,SAAIsB,MAAJ,CAAW,GAAX,EAAgB7B,IAAhB,CAAqB;AACnBqC,eAAS,IADU;AAEnBrB,eAAS,mBAFU;AAGnBkB,aAAOA;AAHY,MAArB;AAKA,KAZD,MAYO;AACN3B,SAAIP,IAAJ,CAAS,EAAEqC,SAAS,KAAX,EAAkBrB,SAAS,wCAA3B,EAAT;AACA;AACD,IAjBD;AAkBA,GApBD,MAoBO;AACNT,OAAIP,IAAJ,CAAS,EAAEqC,SAAS,KAAX,EAAkBrB,SAAS,wCAA3B,EAAT;AACA;AACD,EA1BD;AA2BA,CA5BM;;AA8BP;AACO,IAAMK,gDAAoB,SAApBA,iBAAoB,CAACf,GAAD,EAAMC,GAAN,EAAW+B,IAAX,EAAoB;;AAEnD;AACA,KAAIJ,QAAQ5B,IAAIoB,IAAJ,CAASQ,KAAT,IAAkB5B,IAAIiC,KAAJ,CAAUL,KAA5B,IAAqC5B,IAAIkC,OAAJ,CAAY,gBAAZ,CAAjD;;AAEA;AACA,KAAIN,KAAJ,EAAW;AACT;AACA,yBAAIO,MAAJ,CAAWP,KAAX,EAAkBX,SAAlB,EAA6B,UAACnC,GAAD,EAAMsD,OAAN,EAAkB;AAC7C,OAAItD,GAAJ,EAAS;AACP,WAAOmB,IAAIP,IAAJ,CAAS,EAAEqC,SAAS,KAAX,EAAkBrB,SAAS,+BAA3B,EAAT,CAAP;AACD,IAFD,MAEO;AACL;AACAV,QAAIoC,OAAJ,GAAcA,OAAd;AACAJ;AACD;AACF,GARD;AASD,EAXD,MAWO;AACL;AACA,SAAO/B,IAAIsB,MAAJ,CAAW,GAAX,EAAgBc,IAAhB,CAAqB;AACxBN,YAAS,KADe;AAExBrB,YAAS;AAFe,GAArB,CAAP;AAID;AACF,CAxBM;;AA0BA,IAAMM,8BAAW,SAAXA,QAAW,CAAChB,GAAD,EAAMC,GAAN,EAAc;AACrC,cAAGqC,UAAH,+BAAkCd,OAAlC,CAA0C,EAAE,YAAYxB,IAAIuC,MAAJ,CAAWC,EAAzB,EAA1C,EAAyE,UAAC1D,GAAD,EAAM2D,GAAN,EAAc;AACrF,MAAI3D,GAAJ,EAAS;AACP4D,eAAYzC,GAAZ,EAAiBnB,IAAI4B,OAArB,EAA8B,sBAA9B;AACD,GAFD,MAEO;AACLT,OAAIsB,MAAJ,CAAW,GAAX,EAAgB7B,IAAhB,CAAqB,EAAEyB,UAAUsB,IAAItB,QAAhB,EAArB;AACD;AACC,EANJ;AAOA,CARM,C;;;;;;AC7EP,yC;;;;;;;;;;;;;;ACAA;;;;AACA;;;;AACA;;;;AAEA,IAAMwB,mBAAmB,EAAzB;;AAEA,IAAMC,aAAa,IAAI,mBAASC,MAAb,CAAoB;AACnC1B,cAAU,EAAE2B,MAAMC,MAAR,EAAgBC,UAAU,IAA1B,EAAgCC,OAAO,EAAEC,QAAQ,IAAV,EAAvC,EADyB;AAEnC7B,cAAU,EAAEyB,MAAMC,MAAR,EAAgBC,UAAU,IAA1B;AAFyB,CAApB,CAAnB;;AAKAJ,WAAWO,GAAX,CAAe,MAAf,EAAuB,UAASnB,IAAT,EAAe;AAAE;AACpC,QAAIP,OAAO,IAAX;;AAEA;AACA,QAAI,CAACA,KAAK2B,UAAL,CAAgB,UAAhB,CAAL,EAAkC,OAAOpB,MAAP;;AAElC;AACA,qBAAOqB,OAAP,CAAeV,gBAAf,EAAiC,UAAS7D,GAAT,EAAcwE,IAAd,EAAoB;AACjD,YAAIxE,GAAJ,EAAS,OAAOkD,KAAKlD,GAAL,CAAP;;AAET;AACA,yBAAOyE,IAAP,CAAY9B,KAAKJ,QAAjB,EAA2BiC,IAA3B,EAAiC,UAASxE,GAAT,EAAcyE,IAAd,EAAoB;AACjD,gBAAIzE,GAAJ,EAAS,OAAOkD,KAAKlD,GAAL,CAAP;;AAET;AACA2C,iBAAKJ,QAAL,GAAgBkC,IAAhB;AACAvB;AACH,SAND;AAOH,KAXD;AAYH,CAnBD;;AAqBAY,WAAWY,OAAX,CAAmB9B,eAAnB,GAAqC,UAAS+B,iBAAT,EAA4BC,EAA5B,EAAgC;AAAE;AACnE,qBAAOC,OAAP,CAAeF,iBAAf,EAAkC,KAAKpC,QAAvC,EAAiD,UAASvC,GAAT,EAAc6C,OAAd,EAAuB;AACpE,YAAI7C,GAAJ,EAAS,OAAO4E,GAAG5E,GAAH,CAAP;AACT4E,WAAG,IAAH,EAAS/B,OAAT;AACH,KAHD;AAIH,CALD;;AAOO,IAAMiC,gCAAY,mBAASC,KAAT,CAAe,MAAf,EAAuBjB,UAAvB,+BAAlB,C;;;;;;ACvCP,mC;;;;;;ACAA,mC;;;;;;;;;;;;;ACAA;;;;AAEA;;IAAYkB,kB;;;;;;AAEZ,IAAMtD,SAAS,kBAAQC,MAAR,EAAf;;AAEA;;AAEAD,OAAOT,GAAP,CAAW,GAAX,EAAgB,UAACC,GAAD,EAAMC,GAAN,EAAc;AAC1BA,MAAIP,IAAJ,CAAS,EAAEgB,SAAS,iCAAX,EAAT;AACH,CAFD;;AAIAF,OAAOT,GAAP,CAAW,UAAX,EAAuB,UAACC,GAAD,EAAMC,GAAN,EAAc;AACpC,MAAID,IAAIiC,KAAJ,CAAU,kBAAV,MAAkCjD,QAAQC,GAAR,CAAY8E,YAAlD,EAAgE;AAC3D9D,QAAIoC,IAAJ,CAASrC,IAAIiC,KAAJ,CAAU,eAAV,CAAT;AACD,GAFJ,MAEU;AACLhC,QAAIoC,IAAJ,CAAS,+BAAT;AACD;AACJ,CAND;;AAQA7B,OAAOI,IAAP,CAAY,UAAZ,EAAwBkD,mBAAmBE,OAA3C;;AAEA;;;;AAIAxD,OAAOT,GAAP,CAAW,iBAAX,EAA8B+D,mBAAmBG,cAAjD;;kBAEezD,M;;;;;;;;;;;;;;AC5Bf;;;;AAEA;;IAAY0D,iB;;;;;;AAEL,IAAMF,4BAAU,SAAVA,OAAU,CAAChE,GAAD,EAAMC,GAAN,EAAc;;AAEnC;AACA,KAAID,IAAIoB,IAAJ,CAAS+C,MAAT,IAAmB,MAAvB,EAA+B;AAC7B;AACA;AACAnE,MAAIoB,IAAJ,CAASgD,KAAT,CAAeC,OAAf,CAAuB,UAACD,KAAD,EAAW;AAChC;AACAA,SAAME,SAAN,CAAgBD,OAAhB,CAAwB,UAACE,KAAD,EAAW;AACvC,QAAIA,MAAM7D,OAAV,EAAmB;AACX8D,oBAAeD,KAAf;AACD,KAFP,MAEa,IAAIA,MAAME,QAAV,EAAoB;AAChC,SAAIF,MAAMG,MAAN,CAAalC,EAAb,KAAoBxD,QAAQC,GAAR,CAAY0F,YAAhC,IAAgDJ,MAAMG,MAAN,CAAalC,EAAb,KAAoBxD,QAAQC,GAAR,CAAY2F,KAApF,EAA2F;AAC1FC,wBAAkBN,KAAlB;AACA;AACD;AACI,IARD;AASD,GAXD;;AAaAtE,MAAI6E,UAAJ,CAAe,GAAf;AACD;AACF,CArBM;;AAuBP;;;;AAIA,SAASN,cAAT,CAAwBD,KAAxB,EAA+B;AAC3B,KAAI7D,UAAU6D,MAAM7D,OAApB;AACA,KAAIqE,WAAWR,MAAMG,MAAN,CAAalC,EAA5B;;AAEA;AACA,KAAI9B,QAAQsE,IAAZ,EAAkB;AAChB,MAAIC,eAAevE,QAAQsE,IAAR,CAAaE,WAAb,GAA2BC,IAA3B,EAAnB;AACJ;AACA;AACA;;;;;;;;;;;;;;;;;;;AAmBAC,oBAAkBH,YAAlB,EAAgCF,QAAhC,EAA0C,YAA1C;AACG,EAxBD,MAwBO,IAAIrE,QAAQ2E,WAAZ,EAAyB;AAC9BC,cAAYP,QAAZ,EAAsB,EAACC,MAAM,yCAAP,EAAtB;AACD;AACJ;;AAED,SAASH,iBAAT,CAA2BN,KAA3B,EAAkC;AAChC,KAAIQ,WAAWR,MAAMG,MAAN,CAAalC,EAA5B;AACA,KAAI+C,UAAUhB,MAAME,QAAN,CAAec,OAA7B;AACD;;AAED,SAASH,iBAAT,CAA2BI,gBAA3B,EAA6CC,WAA7C,EAA0DC,aAA1D,EAAyE;AACxEC,mBAAkBC,UAAlB,CAA6BJ,gBAA7B,EAA+CK,IAA/C,CAAoD,UAACC,QAAD,EAAWhH,GAAX,EAAmB;AACtE,MAAIA,GAAJ,EAAS;AACR;AACA,GAFD,MAEO,IAAIgH,YAAYA,SAASC,KAAT,CAAe,CAAf,CAAhB,EAAmC;AACzC,OAAIC,YAAYF,SAASC,KAAT,CAAe,CAAf,CAAhB;AACA,OAAIrF,UAAU;AACb,kBAAc;AACZ,aAAQ,UADI;AAEZ,gBAAW;AACX,uBAAgB,SADL;AAEZ,kBAAW,CACR;AACF,gBAASsF,UAAUC,OAAV,CAAkBC,KADzB;AAEF,oBAAaF,UAAUC,OAAV,CAAkBE,UAAlB,CAA6BC,MAA7B,CAAoCC,GAF/C;AAGF,mBAAYL,UAAUC,OAAV,CAAkBK,WAH5B;AAIF,yBAAkB;AAChB,gBAAQ,SADQ;AAEhB,oDAA0CN,UAAUxD,EAAV,CAAa+D;AAFvC;AAJhB,OADQ;AAFC;AAFC;AADD,IAAd;AAmBAjB,eAAYG,WAAZ,EAAyB/E,OAAzB;AACA;AACD,EA1BD;AA2BA;;AAED;AACA,SAAS4E,WAAT,CAAqBG,WAArB,EAAkC/E,OAAlC,EAA2C;AACzC,wBAAQ;AACN2F,OAAK,8CADC;AAENG,MAAI,EAACC,cAAczH,QAAQC,GAAR,CAAYyH,iBAA3B,EAFE;AAGNC,UAAQ,MAHF;AAINjH,QAAM;AACJkH,cAAW,EAACpE,IAAIiD,WAAL,EADP;AAEJ/E,YAASA;AAFL;AAJA,EAAR,EAQG,UAASmG,KAAT,EAAgBf,QAAhB,EAA0B1E,IAA1B,EAAgC;AACjC,MAAIyF,KAAJ,EAAW;AACTjI,WAAQC,GAAR,CAAY,4BAA4BiH,SAASe,KAAjD;AACD,GAFD,MAEO;AACR;AACD;AACC,EAdD;AAeD;;AAED;;;;AAIO,IAAM5C,0CAAiB,SAAjBA,cAAiB,CAACjE,GAAD,EAAMC,GAAN,EAAc;AAC3CiE,mBAAkB0B,UAAlB,CAA6B5F,IAAIiC,KAAJ,CAAU,cAAV,CAA7B,EAAwD4D,IAAxD,CAA6D,UAACiB,kBAAD,EAAqBhI,GAArB,EAA6B;AACzF,MAAIA,GAAJ,EAAS;AACP4D,eAAYzC,GAAZ,EAAiBnB,IAAI4B,OAArB,EAA8B,kBAA9B;AACD,GAFD,MAEO;AACLT,OAAIsB,MAAJ,CAAW,GAAX,EAAgB7B,IAAhB,CAAqBoH,kBAArB;AACD;AACD,EAND;AAOA,CARM,C;;;;;;AC3HP,oC;;;;;;;;;;;;;;ACAA;;;;;;AAEA,IAAMC,eAAe,qBAAOA,YAAP,CAAoB,IAApB,CAArB;AACA,IAAMC,UAAU,qBAAOA,OAAP,CAAe,IAAf,CAAhB;;AAEA,IAAMC,aAAa,YAAnB;;AAEO,IAAMrB,kCAAa,SAAbA,UAAa,CAACsB,WAAD,EAAiB;AAC1C,KAAIC,oBAAoB,IAAIC,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;;AAExDN,UAAQO,MAAR,CAAeC,IAAf,CAAoB;AACnBC,SAAMzI,QAAQC,GAAR,CAAYyI,OADC;AAEnBC,eAAY,GAFO;AAGfC,SAAM,SAHS;AAIfC,MAAMZ,UAAN,SAAoBC;AAJL,GAApB,EAKG,UAACpI,GAAD,EAAMgH,QAAN,EAAmB;AACrB,OAAIhH,GAAJ,EAAS;AACTwI,WAAO,kBAAP;AACC,IAFD,MAEO;AACPD,YAAQvB,QAAR;AACC;AACD,GAXD;AAYA,EAduB,CAAxB;;AAgBA,QAAOqB,iBAAP;AACA,CAlBM,C;;;;;;ACPP,uC","file":"server.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/build/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 3);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap b5ffd4af9aa3d4195dd7","module.exports = require(\"express\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"express\"\n// module id = 0\n// module chunks = 0","module.exports = require(\"mongoose\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"mongoose\"\n// module id = 1\n// module chunks = 0","import dotenv from 'dotenv';\r\nimport mongoose from 'mongoose';\r\n\r\nconst config = dotenv.config();\r\n\r\n// Create a database variable outside of the database connection callback to reuse the connection pool in your app.\r\n\r\nexport const MEADOWS_COLLECTION = \"meadows\";\r\n\r\nmongoose.connection.on(\"open\", function(ref) {\r\n  console.log(\"Connected to mongo server.\");\r\n});\r\n\r\nmongoose.connection.on(\"error\", function(err) {\r\n  console.log(\"Could not connect to mongo server!\");\r\n});\r\n\r\nmongoose.connect(process.env.MONGODB_URI || `mongodb://${process.env.DB_USER}:${process.env.DB_PASS}@ds149122.mlab.com:49122/cryptic-meadow-db`);\r\nexport const db = mongoose.connection;\n\n\n// WEBPACK FOOTER //\n// ./src/databases/mongo_db.js","import express from 'express';\r\nimport socketIO from 'socket.io';\r\n\r\nimport bodyParser from 'body-parser';\r\n\r\nimport router from './routes/router';\r\n\r\nconst app = express();\r\n\r\n// configure app to use bodyParser()\r\napp.use(bodyParser.urlencoded({ extended: true }));\r\napp.use(bodyParser.json());\r\n\r\nconst port = process.env.PORT || 8080; // set our port\r\n\r\n//define public directory\r\napp.use(\"/\", express.static(__dirname + '/public'));\r\n\r\n// define served pages\r\napp.get('/paint-socket', function (req, res) {\r\n  res.sendFile(__dirname + '/public/paint-socket.html');\r\n});\r\n\r\n// all of our routes will be prefixed with /api\r\napp.use('/api', router);\r\n\r\nconst io = socketIO.listen(app.listen(port)); //start server + socket\r\n\r\nconsole.log('Magic happens on port ' + port);\r\n\r\nio.on('connection', (socket) => {\r\n  socket.on('submit', (doodleData) => {\r\n    io.emit('publish', doodleData);\r\n  });\r\n});\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/main.js","module.exports = require(\"socket.io\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"socket.io\"\n// module id = 4\n// module chunks = 0","module.exports = require(\"body-parser\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"body-parser\"\n// module id = 5\n// module chunks = 0","import express from 'express';\r\n\r\n// sub-routes imports\r\nimport user from './user.routes';\r\nimport chatbot from './chatbot.routes';\r\n\r\nconst router = express.Router();\r\n\r\n// test route to make sure everything is working\r\nrouter.get('/', function(req, res) {\r\n    res.json({ message: 'hooray! welcome to our api!' });   \r\n});\r\n\r\n// use sub routes\r\nrouter.use('/user', user);\r\nrouter.use('/chatbot', chatbot);\r\n\r\nexport default router;\n\n\n// WEBPACK FOOTER //\n// ./src/routes/router.js","import express from 'express';\r\n\r\nimport * as user_controller from '../controllers/user.controller';\r\n\r\nconst router = express.Router();\r\n\r\n// define routes\r\n\r\nrouter.post('/signup', user_controller.user_signup);\r\n\r\nrouter.post('/login', user_controller.user_login);\r\n\r\n// route middleware to verify a token on all following user routes\r\nrouter.use(user_controller.user_verify_token);\r\n\r\nrouter.get('/:id', user_controller.user_get);\r\n\t\r\nexport default router;\r\n\t\n\n\n// WEBPACK FOOTER //\n// ./src/routes/user.routes.js","import jwt from 'jsonwebtoken';\r\n\r\nimport {UserModel} from '../models/user.model';\r\n\r\nimport {db, MEADOWS_COLLECTION} from '../databases/mongo_db';\r\n\r\nconst AT_STRING = 'thisisthestring';\r\n\r\nexport const user_signup = (req, res) => {\r\n\tlet user_temp = new UserModel({\r\n\t\tusername: req.body.username,\r\n\t\tpassword: req.body.password\r\n\t});\r\n\t\r\n\tuser_temp.save((err) => {\r\n\t\tif (err) { throw err; }\r\n\t\tres.status(200).json({});\r\n\t  });\r\n};\r\n\r\nexport const user_login = (req, res) => {\r\n\tUserModel.findOne({ username: req.body.username }, (err, user) => {\r\n\t\tif (err) throw err;\r\n\t\t\r\n\t\tif (user) {\r\n\t\t\t// test a matching password\r\n\t\t\tuser.comparePassword(req.body.password, (err, isMatch) => {\r\n\t\t\t\tif (err) throw err;\r\n\t\t\t\tif (isMatch) {\r\n\t\t\t\t\t// if user is found and password is right - create a token\r\n\t\t\t\t\tlet token = jwt.sign(user, AT_STRING, {\r\n\t\t\t\t\t  expiresIn: 180\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\t// return the information including token as JSON\r\n\t\t\t\t\tres.status(200).json({\r\n\t\t\t\t\t  success: true,\r\n\t\t\t\t\t  message: 'Enjoy your token!',\r\n\t\t\t\t\t  token: token\r\n\t\t\t\t\t});\r\n\t\t\t\t} else {\r\n\t\t\t\t\tres.json({ success: false, message: 'Authentication failed. Wrong password.' });\r\n\t\t\t\t}\r\n\t\t\t});    \r\n\t\t} else {\r\n\t\t\tres.json({ success: false, message: 'Authentication failed. User not found.' });\r\n\t\t}\r\n\t});\r\n};\r\n\r\n// route middleware to verify a token\r\nexport const user_verify_token = (req, res, next) => {\r\n\r\n  // check header or url parameters or post parameters for token\r\n  let token = req.body.token || req.query.token || req.headers['x-access-token'];\r\n\r\n  // decode token\r\n  if (token) {\r\n    // verifies secret and checks exp\r\n    jwt.verify(token, AT_STRING, (err, decoded) => {      \r\n      if (err) {\r\n        return res.json({ success: false, message: 'Failed to authenticate token.' });    \r\n      } else {\r\n        // if everything is good, save to request for use in other routes\r\n        req.decoded = decoded;    \r\n        next();\r\n      }\r\n    });\r\n  } else {\r\n    // if there is no token - return an error\r\n    return res.status(403).send({ \r\n        success: false, \r\n        message: 'No token provided.' \r\n    });\r\n  }\r\n};\r\n\r\nexport const user_get = (req, res) => {\r\n\tdb.collection(MEADOWS_COLLECTION).findOne({ 'username': req.params.id }, (err, doc) => {\r\n\t\t\tif (err) {\r\n\t\t\t  handleError(res, err.message, \"Failed to get meadow\");\r\n\t\t\t} else {\r\n\t\t\t  res.status(200).json({ username: doc.username });\r\n\t\t\t}\r\n\t\t  });\r\n};\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/controllers/user.controller.js","module.exports = require(\"jsonwebtoken\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"jsonwebtoken\"\n// module id = 9\n// module chunks = 0","import mongoose from 'mongoose';\r\nimport bcrypt from 'bcrypt';\r\nimport {MEADOWS_COLLECTION} from '../databases/mongo_db';\r\n\r\nconst SALT_WORK_FACTOR = 10;\r\n\r\nconst userSchema = new mongoose.Schema({\r\n    username: { type: String, required: true, index: { unique: true } },\r\n    password: { type: String, required: true }\r\n});\r\n\r\nuserSchema.pre('save', function(next) { // generate salt and hash before sving password prop.\r\n    var user = this;\r\n\r\n    // only hash the password if it has been modified (or is new)\r\n    if (!user.isModified('password')) return next();\r\n\r\n    // generate a salt\r\n    bcrypt.genSalt(SALT_WORK_FACTOR, function(err, salt) {\r\n        if (err) return next(err);\r\n\r\n        // hash the password along with our new salt\r\n        bcrypt.hash(user.password, salt, function(err, hash) {\r\n            if (err) return next(err);\r\n\r\n            // override the cleartext password with the hashed one\r\n            user.password = hash;\r\n            next();\r\n        });\r\n    });\r\n});\r\n\r\nuserSchema.methods.comparePassword = function(candidatePassword, cb) { // compare password method, to verify password matching\r\n    bcrypt.compare(candidatePassword, this.password, function(err, isMatch) {\r\n        if (err) return cb(err);\r\n        cb(null, isMatch);\r\n    });\r\n};\r\n\r\nexport const UserModel = mongoose.model('User', userSchema, MEADOWS_COLLECTION);\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/models/user.model.js","module.exports = require(\"bcrypt\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"bcrypt\"\n// module id = 11\n// module chunks = 0","module.exports = require(\"dotenv\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"dotenv\"\n// module id = 12\n// module chunks = 0","import express from 'express';\r\n\r\nimport * as chatbot_controller from '../controllers/chatbot.controller';\r\n\r\nconst router = express.Router();\r\n\r\n// define routes\r\n\r\nrouter.get('/', (req, res) => {\r\n    res.json({ message: 'hooray! welcome to our chatbot!' });   \r\n});\r\n\r\nrouter.get('/webhook', (req, res) => {\r\n\tif (req.query['hub.verify_token'] === process.env.VERIFY_TOKEN) {\r\n      res.send(req.query['hub.challenge']);\r\n    } else {\r\n      res.send('Error, wrong validation token');    \r\n    } \r\n});\r\n\r\nrouter.post('/webhook', chatbot_controller.webhook);\r\n\r\n/**\r\n * YouTube API Test Routes\r\n **/\r\n \r\nrouter.get('/youtube_search', chatbot_controller.youtube_search);\r\n\t\r\nexport default router;\r\n\t\n\n\n// WEBPACK FOOTER //\n// ./src/routes/chatbot.routes.js","import request from 'request';\r\n\r\nimport * as youTubeApiService from '../services/youtube_api.service';\r\n\r\nexport const webhook = (req, res) => {\r\n\r\n  // Make sure this is a page subscription\r\n  if (req.body.object == \"page\") {\r\n    // Iterate over each entry\r\n    // There may be multiple entries if batched\r\n    req.body.entry.forEach((entry) => {\r\n      // Iterate over each messaging event\r\n      entry.messaging.forEach((event) => {\r\n\t\tif (event.message) {\r\n          processMessage(event);\r\n        } else if (event.postback) {\r\n\t\t\tif (event.sender.id === process.env.MY_MICHAL_ID || event.sender.id === process.env.MY_ID) {\r\n\t\t\t\tprocessMyPostback(event);\r\n\t\t\t}\r\n\t\t}\r\n      });\r\n    });\r\n\r\n    res.sendStatus(200);\r\n  }\r\n}\r\n\r\n/**\r\n * Chatbot Functions\r\n **/\r\n\r\nfunction processMessage(event) {\r\n    let message = event.message;\r\n    let senderId = event.sender.id;\r\n\r\n    // You may get a text or attachment but not both\r\n    if (message.text) {\r\n      let formattedMsg = message.text.toLowerCase().trim();\r\n\t\t// Get user's first name from the User Profile API\r\n\t\t// and include it in the greeting\r\n\t\t/*\r\n\t\trequest({\r\n\t\t  url: \"https://graph.facebook.com/v2.10/\" + senderId,\r\n\t\t  qs: {\r\n\t\t\taccess_token: process.env.PAGE_ACCESS_TOKEN,\r\n\t\t\tfields: \"first_name\"\r\n\t\t  },\r\n\t\t  method: \"GET\"\r\n\t\t}, (error, response, body) => {\r\n\t\t  if (error) {\r\n\t\t\tconsole.log(\"Error getting user's name: \" +  error);\r\n\t\t  } else {\r\n\t\t\tlet bodyObj = JSON.parse(body);\r\n\t\t\tlet senderName = bodyObj.first_name;\r\n\t\t\tfetchVideoAndSend(formattedMsg, senderId, senderName);\r\n\t\t  }\r\n\t\t  \r\n\t\t});\r\n\t\t*/\r\n\t\tfetchVideoAndSend(formattedMsg, senderId, 'senderName');\r\n    } else if (message.attachments) {\r\n      sendMessage(senderId, {text: \"Sorry, I don't understand your request.\"});\r\n    }\r\n}\r\n\r\nfunction processMyPostback(event) {\r\n  let senderId = event.sender.id;\r\n  let payload = event.postback.payload;\r\n}\r\n\r\nfunction fetchVideoAndSend(formattedMessage, recipientId, recipientName) {\r\n\tyoutubeApiService.searchList(formattedMessage).then((response, err) => {\r\n\t\tif (err) {\r\n\t\t\t//TODO: handle error\r\n\t\t} else if (response && response.items[0]) {\r\n\t\t\tlet videoData = response.items[0];\r\n\t\t\tlet message = {\r\n\t\t\t\t\"attachment\": {\r\n\t\t\t\t  \"type\": \"template\",\r\n\t\t\t\t  \"payload\": {\r\n\t\t\t\t  \"template_type\":\"generic\",\r\n\t\t\t\t\t\"elements\":[\r\n\t\t\t\t\t   {\r\n\t\t\t\t\t\t\"title\": videoData.snippet.title,\r\n\t\t\t\t\t\t\"image_url\": videoData.snippet.thumbnails.medium.url,\r\n\t\t\t\t\t\t\"subtitle\": videoData.snippet.description,\r\n\t\t\t\t\t\t\"default_action\": {\r\n\t\t\t\t\t\t  \"type\": \"web_url\",\r\n\t\t\t\t\t\t  \"url\": `https://www.youtube.com/watch?v=${videoData.id.videoId}`,\r\n\t\t\t\t\t\t}      \r\n\t\t\t\t\t  }\r\n\t\t\t\t\t]\r\n\t\t\t\t  }\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tsendMessage(recipientId, message)\r\n\t\t}\r\n\t})\r\n}\r\n\r\n// sends message to user\r\nfunction sendMessage(recipientId, message) {\r\n  request({\r\n    url: \"https://graph.facebook.com/v2.10/me/messages\",\r\n    qs: {access_token: process.env.PAGE_ACCESS_TOKEN},\r\n    method: \"POST\",\r\n    json: {\r\n      recipient: {id: recipientId},\r\n      message: message,\r\n    }\r\n  }, function(error, response, body) {\r\n    if (error) {\r\n      console.log(\"Error sending message: \" + response.error);\r\n    } else {\r\n\t  //console.log(response);\r\n\t}\r\n  });\r\n}\r\n\r\n/**\r\n * YouTube API Test functions\r\n **/\r\n\r\nexport const youtube_search = (req, res) => {\r\n\tyouTubeApiService.searchList(req.query['query_string']).then((searchListRepoonse, err) => {\r\n\t\tif (err) {\r\n\t\t  handleError(res, err.message, \"searchList Error\");\r\n\t\t} else {\r\n\t\t  res.status(200).json(searchListRepoonse);\r\n\t\t}\r\n\t})\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/controllers/chatbot.controller.js","module.exports = require(\"request\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"request\"\n// module id = 15\n// module chunks = 0","import google from 'googleapis';\r\n\r\nconst urlshortener = google.urlshortener('v1');\r\nconst youtube = google.youtube('v3');\r\n\r\nconst constQuery = 'Paul Simon';\r\n\r\nexport const searchList = (queryString) => {\r\n\tlet searchListPromise = new Promise((resolve, reject) => {\r\n\t\r\n\t\tyoutube.search.list({\r\n\t\t\tauth: process.env.API_KEY,\r\n\t\t\tmaxResults: '1',\r\n\t\t\t\t\t\t\tpart: 'snippet',\r\n\t\t\t\t\t\t\tq: `${constQuery} ${queryString}`\r\n\t\t}, (err, response) => {\r\n\t\t\tif (err) {\r\n\t\t\treject('searchList error');\r\n\t\t\t} else {\r\n\t\t\tresolve(response);\r\n\t\t\t}\r\n\t\t});\r\n\t});\r\n\t\r\n\treturn searchListPromise;\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/services/youtube_api.service.js","module.exports = require(\"googleapis\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"googleapis\"\n// module id = 17\n// module chunks = 0"],"sourceRoot":""}