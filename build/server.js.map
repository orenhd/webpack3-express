{"version":3,"sources":["webpack:///webpack/bootstrap 96de4da39e230ad15d51","webpack:///./src/config/index.js","webpack:///external \"express\"","webpack:///external \"mongoose\"","webpack:///./src/app.js","webpack:///external \"socket.io\"","webpack:///external \"body-parser\"","webpack:///external \"dotenv\"","webpack:///./src/routes/router.js","webpack:///./src/routes/user.routes.js","webpack:///./src/controllers/user.controller.js","webpack:///external \"jsonwebtoken\"","webpack:///./src/models/user.model.js","webpack:///external \"bcrypt\"","webpack:///./src/routes/chatbot.routes.js","webpack:///./src/controllers/chatbot.controller.js","webpack:///external \"request\"","webpack:///./src/services/youtube_api.service.js","webpack:///external \"googleapis\"","webpack:///./src/socket-bindings/index.js","webpack:///./src/socket-bindings/paint-socket.js"],"names":["config","env","process","NODE_ENV","app","port","PORT","at_string","AT_STRING","databases","mongodb","uri","MONGODB_URI","usersCollection","chatbot","verifyToken","VERIFY_TOKEN","pageAccessToken","PAGE_ACCESS_TOKEN","services","youtube_api","apiKey","API_KEY","socketBindings","connection","on","ref","console","log","err","connect","useMongoClient","use","urlencoded","extended","json","static","__dirname","get","req","res","sendFile","next","error","status","success","message","send","server","listen","io","bind","router","Router","user_controller","post","user_signup","user_login","user_verify_token","user_get","user_temp","username","body","password","save","findOne","user","comparePassword","isMatch","token","sign","expiresIn","data","query","headers","verify","decoded","params","id","doc","SALT_WORK_FACTOR","userSchema","Schema","type","String","required","index","unique","pre","isModified","genSalt","salt","hash","methods","candidatePassword","cb","compare","UserModel","model","chatbot_controller","webhook","youtube_search","youTubeApiService","object","entry","forEach","messaging","event","processMessage","postback","sendStatus","senderId","sender","text","formattedMsg","toLowerCase","trim","fetchVideoAndSend","attachments","sendMessage","processMyPostback","payload","formattedMessage","recipientId","recipientName","searchList","then","response","items","videoData","snippet","title","thumbnails","medium","url","description","videoId","qs","access_token","method","recipient","searchListRepoonse","urlshortener","youtube","constQuery","queryString","searchListPromise","Promise","resolve","reject","search","list","auth","maxResults","part","q","paintSocketBindings","of","socket","doodleData","emit"],"mappings":"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","file":"server.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/build/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 3);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 96de4da39e230ad15d51","import dotenv from 'dotenv';\r\n\r\ndotenv.config();\r\n\r\nconst config = {\r\n    env: process.env.NODE_ENV,\r\n    app: {\r\n        port: process.env.PORT || 8080,\r\n        at_string: process.env.AT_STRING,\r\n    },\r\n    databases: {\r\n        mongodb: {\r\n            uri: process.env.MONGODB_URI,\r\n            usersCollection: 'meadows',\r\n        },\r\n    },\r\n    chatbot: {\r\n        verifyToken: process.env.VERIFY_TOKEN,\r\n        pageAccessToken: process.env.PAGE_ACCESS_TOKEN,\r\n    },\r\n    services: {\r\n        youtube_api: {\r\n            apiKey: process.env.API_KEY,\r\n        }\r\n    }\r\n}\r\n\r\nexport default config;\n\n\n// WEBPACK FOOTER //\n// ./src/config/index.js","module.exports = require(\"express\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"express\"\n// module id = 1\n// module chunks = 0","module.exports = require(\"mongoose\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"mongoose\"\n// module id = 2\n// module chunks = 0","import mongoose from 'mongoose';\r\nimport express from 'express';\r\nimport socketIO from 'socket.io';\r\n\r\nimport bodyParser from 'body-parser';\r\n\r\nimport config from './config';\r\n;\r\nimport router from './routes/router';\r\n\r\nimport * as socketBindings from './socket-bindings';\r\n\r\n//init mongodb connection\r\nmongoose.connection.on(\"open\", function (ref) {\r\n  console.log(\"Connected to mongo server.\");\r\n});\r\n\r\nmongoose.connection.on(\"error\", function (err) {\r\n  console.log(\"Could not connect to mongo server!\", err);\r\n});\r\n\r\nmongoose.connect(config.databases.mongodb.uri, { useMongoClient: true });\r\n\r\nconst app = express();\r\n\r\n// configure app to use bodyParser()\r\napp.use(bodyParser.urlencoded({ extended: true }));\r\napp.use(bodyParser.json());\r\n\r\n//define public directory\r\napp.use(\"/\", express.static(__dirname + '/public'));\r\n\r\n// define served pages\r\napp.get('/paint-socket', function (req, res) {\r\n  res.sendFile(__dirname + '/public/paint-socket.html');\r\n});\r\n\r\n// all of our routes will be prefixed with /api\r\napp.use('/api', router);\r\n\r\n// configure error handler\r\napp.use((err, req, res, next) => {\r\n  console.error(err);\r\n  res.status(500).json({ success: false, message: err });\r\n})\r\n\r\n// configure 404 handler\r\napp.use((req, res, next) => {\r\n  res.status(404).send('Sorry, not found.')\r\n})\r\n\r\n//start server + socket\r\nconst server = app.listen(config.app.port, () => {\r\n  console.log(`Magic happens on port ${config.app.port}, on environment '${config.env}'.`);\r\n});\r\nconst io = socketIO.listen(server);\r\n\r\n// init. socket bindings\r\nsocketBindings.bind(io);\r\n\r\n\r\n\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/app.js","module.exports = require(\"socket.io\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"socket.io\"\n// module id = 4\n// module chunks = 0","module.exports = require(\"body-parser\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"body-parser\"\n// module id = 5\n// module chunks = 0","module.exports = require(\"dotenv\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"dotenv\"\n// module id = 6\n// module chunks = 0","import express from 'express';\r\n\r\n// sub-routes imports\r\nimport user from './user.routes';\r\nimport chatbot from './chatbot.routes';\r\n\r\nconst router = express.Router();\r\n\r\n// test route to make sure everything is working\r\nrouter.get('/', function(req, res) {\r\n    res.status(200).json({ success: true, message: 'hooray! welcome to our api!' });   \r\n});\r\n\r\n// use sub routes\r\nrouter.use('/user', user);\r\nrouter.use('/chatbot', chatbot);\r\n\r\nexport default router;\n\n\n// WEBPACK FOOTER //\n// ./src/routes/router.js","import express from 'express';\r\n\r\nimport * as user_controller from '../controllers/user.controller';\r\n\r\nconst router = express.Router();\r\n\r\n// define routes\r\n\r\nrouter.post('/signup', user_controller.user_signup);\r\n\r\nrouter.post('/login', user_controller.user_login);\r\n\r\n// route middleware to verify a token on all following user routes\r\nrouter.use(user_controller.user_verify_token);\r\n\r\nrouter.get('/:id', user_controller.user_get);\r\n\t\r\nexport default router;\r\n\t\n\n\n// WEBPACK FOOTER //\n// ./src/routes/user.routes.js","import jwt from 'jsonwebtoken';\r\n\r\nimport { UserModel } from '../models/user.model';\r\n\r\nimport config from '../config';\r\n\r\nexport const user_signup = (req, res, next) => {\r\n\tlet user_temp = new UserModel({\r\n\t\tusername: req.body.username,\r\n\t\tpassword: req.body.password\r\n\t});\r\n\r\n\tuser_temp.save((err) => {\r\n\t\tif (err) {\r\n\t\t\tnext(err);\r\n\t\t} else {\r\n\t\t\tres.status(200).json({ success: true });\r\n\t\t}\r\n\t});\r\n};\r\n\r\nexport const user_login = (req, res, next) => {\r\n\tUserModel.findOne({ username: req.body.username }, (err, user) => {\r\n\t\tif (err) {\r\n\t\t\tnext(err);\r\n\t\t} else if (user) {\r\n\t\t\t// test a matching password\r\n\t\t\tuser.comparePassword(req.body.password, (err, isMatch) => {\r\n\t\t\t\tif (err) {\r\n\t\t\t\t\tnext(err);\r\n\t\t\t\t} else if (isMatch) {\r\n\t\t\t\t\t// if user is found and password is right - create a token\r\n\t\t\t\t\tlet token = jwt.sign(user, config.app.at_string, {\r\n\t\t\t\t\t\texpiresIn: 180\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\t// return the information including token as JSON\r\n\t\t\t\t\tres.status(200).json({ success: true, data: { token }, message: 'Enjoy your token.' });\r\n\t\t\t\t} else {\r\n\t\t\t\t\tres.status(401).json({ success: false, message: 'Authentication failed. Wrong password.' });\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tres.status(401).json({ success: false, message: 'Authentication failed. User not found.' });\r\n\t\t}\r\n\t});\r\n};\r\n\r\n// route middleware to verify a token\r\nexport const user_verify_token = (req, res, next) => {\r\n\r\n\t// check header or url parameters or post parameters for token\r\n\tlet token = req.body.token || req.query.token || req.headers['x-access-token'];\r\n\r\n\t// decode token\r\n\tif (token) {\r\n\t\t// verifies secret and checks exp\r\n\t\tjwt.verify(token, config.app.at_string, (err, decoded) => {\r\n\t\t\tif (err) {\r\n\t\t\t\tnext(err);\r\n\t\t\t} else {\r\n\t\t\t\t// if everything is good, save to request for use in other routes\r\n\t\t\t\treq.decoded = decoded;\r\n\t\t\t\tnext();\r\n\t\t\t}\r\n\t\t});\r\n\t} else {\r\n\t\t// if there is no token - return an error\r\n\t\treturn res.status(401).send({ success: false, message: 'No token provided.' });\r\n\t}\r\n};\r\n\r\nexport const user_get = (req, res, next) => {\r\n\tUserModel.findOne({ 'username': req.params.id }, (err, doc) => {\r\n\t\tif (err) {\r\n\t\t\tnext(err);\r\n\t\t} else if (doc) {\r\n\t\t\tres.status(200).json({ success: true, data: { username: doc.username } });\r\n\t\t} else {\r\n\t\t\tnext();\r\n\t\t}\r\n\t});\r\n};\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/controllers/user.controller.js","module.exports = require(\"jsonwebtoken\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"jsonwebtoken\"\n// module id = 10\n// module chunks = 0","import mongoose from 'mongoose';\r\nimport bcrypt from 'bcrypt';\r\nimport config from '../config';\r\n\r\nconst SALT_WORK_FACTOR = 10;\r\n\r\nconst userSchema = new mongoose.Schema({\r\n    username: { type: String, required: true, index: { unique: true } },\r\n    password: { type: String, required: true }\r\n});\r\n\r\nuserSchema.pre('save', function(next) { // generate salt and hash before sving password prop.\r\n    var user = this;\r\n\r\n    // only hash the password if it has been modified (or is new)\r\n    if (!user.isModified('password')) return next();\r\n\r\n    // generate a salt\r\n    bcrypt.genSalt(SALT_WORK_FACTOR, function(err, salt) {\r\n        if (err) return next(err);\r\n\r\n        // hash the password along with our new salt\r\n        bcrypt.hash(user.password, salt, function(err, hash) {\r\n            if (err) return next(err);\r\n\r\n            // override the cleartext password with the hashed one\r\n            user.password = hash;\r\n            next();\r\n        });\r\n    });\r\n});\r\n\r\nuserSchema.methods.comparePassword = function(candidatePassword, cb) { // compare password method, to verify password matching\r\n    bcrypt.compare(candidatePassword, this.password, function(err, isMatch) {\r\n        if (err) return cb(err);\r\n        cb(null, isMatch);\r\n    });\r\n};\r\n\r\nexport const UserModel = mongoose.model('User', userSchema, config.databases.mongodb.usersCollection);\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/models/user.model.js","module.exports = require(\"bcrypt\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"bcrypt\"\n// module id = 12\n// module chunks = 0","import express from 'express';\r\nimport config from '../config';\r\n\r\nimport * as chatbot_controller from '../controllers/chatbot.controller';\r\n\r\nconst router = express.Router();\r\n\r\n// define routes\r\n\r\nrouter.get('/', (req, res) => {\r\n    res.status(200).json({ success: true, message: 'hooray! welcome to our chatbot!' });   \r\n});\r\n\r\nrouter.get('/webhook', (req, res) => {\r\n\tif (req.query['hub.verify_token'] === config.chatbot.VERIFY_TOKEN) {\r\n      res.send(req.query['hub.challenge']);\r\n    } else {\r\n      res.send('Error, wrong validation token');    \r\n    } \r\n});\r\n\r\nrouter.post('/webhook', chatbot_controller.webhook);\r\n\r\n/**\r\n * YouTube API Test Routes\r\n **/\r\n \r\nrouter.get('/youtube_search', chatbot_controller.youtube_search);\r\n\t\r\nexport default router;\r\n\t\n\n\n// WEBPACK FOOTER //\n// ./src/routes/chatbot.routes.js","import request from 'request';\r\nimport config from '../config';\r\n\r\nimport * as youTubeApiService from '../services/youtube_api.service';\r\n\r\nexport const webhook = (req, res) => {\r\n\r\n\t// Make sure this is a page subscription\r\n\tif (req.body.object == \"page\") {\r\n\t\t// Iterate over each entry\r\n\t\t// There may be multiple entries if batched\r\n\t\treq.body.entry.forEach((entry) => {\r\n\t\t\t// Iterate over each messaging event\r\n\t\t\tentry.messaging.forEach((event) => {\r\n\t\t\t\tif (event.message) {\r\n\t\t\t\t\tprocessMessage(event);\r\n\t\t\t\t} else if (event.postback) {\r\n\t\t\t\t\t//TODO: process postbacks\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\r\n\t\tres.sendStatus(200);\r\n\t}\r\n}\r\n\r\n/**\r\n * Chatbot Functions\r\n **/\r\n\r\nfunction processMessage(event) {\r\n\tlet message = event.message;\r\n\tlet senderId = event.sender.id;\r\n\r\n\t// You may get a text or attachment but not both\r\n\tif (message.text) {\r\n\t\tlet formattedMsg = message.text.toLowerCase().trim();\r\n\t\tfetchVideoAndSend(formattedMsg, senderId, 'senderName');\r\n\t} else if (message.attachments) {\r\n\t\tsendMessage(senderId, { text: \"Sorry, I don't understand your request.\" });\r\n\t}\r\n}\r\n\r\nfunction processMyPostback(event) {\r\n\tlet senderId = event.sender.id;\r\n\tlet payload = event.postback.payload;\r\n}\r\n\r\nfunction fetchVideoAndSend(formattedMessage, recipientId, recipientName) {\r\n\tyouTubeApiService.searchList(formattedMessage).then((response, err) => {\r\n\t\tif (err) {\r\n\t\t\tconsole.error(\"Error searching video\", err); //TODO: handle error\r\n\t\t} else if (response && response.items[0]) {\r\n\t\t\tlet videoData = response.items[0];\r\n\t\t\tlet message = {\r\n\t\t\t\t\"attachment\": {\r\n\t\t\t\t\t\"type\": \"template\",\r\n\t\t\t\t\t\"payload\": {\r\n\t\t\t\t\t\t\"template_type\": \"generic\",\r\n\t\t\t\t\t\t\"elements\": [\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\"title\": videoData.snippet.title,\r\n\t\t\t\t\t\t\t\t\"image_url\": videoData.snippet.thumbnails.medium.url,\r\n\t\t\t\t\t\t\t\t\"subtitle\": videoData.snippet.description,\r\n\t\t\t\t\t\t\t\t\"default_action\": {\r\n\t\t\t\t\t\t\t\t\t\"type\": \"web_url\",\r\n\t\t\t\t\t\t\t\t\t\"url\": `https://www.youtube.com/watch?v=${videoData.id.videoId}`,\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t]\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tsendMessage(recipientId, message)\r\n\t\t}\r\n\t})\r\n}\r\n\r\n// sends message to user\r\nfunction sendMessage(recipientId, message) {\r\n\trequest({\r\n\t\turl: \"https://graph.facebook.com/v2.10/me/messages\",\r\n\t\tqs: { access_token: config.chatbot.pageAccessToken },\r\n\t\tmethod: \"POST\",\r\n\t\tjson: {\r\n\t\t\trecipient: { id: recipientId },\r\n\t\t\tmessage: message,\r\n\t\t}\r\n\t}, function (error, response, body) {\r\n\t\tif (error) {\r\n\t\t\tconsole.error(\"Error sending message\", error);\r\n\t\t} else {\r\n\t\t\tconsole.log(response);\r\n\t\t}\r\n\t});\r\n}\r\n\r\n/**\r\n * YouTube API Test functions\r\n **/\r\n\r\nexport const youtube_search = (req, res, next) => {\r\n\tyouTubeApiService.searchList(req.query['query_string']).then((searchListRepoonse, err) => {\r\n\t\tif (err) {\r\n\t\t\tnext(err);\r\n\t\t} else {\r\n\t\t\tres.status(200).json({ success: true, data: searchListRepoonse });\r\n\t\t}\r\n\t})\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/controllers/chatbot.controller.js","module.exports = require(\"request\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"request\"\n// module id = 15\n// module chunks = 0","import google from 'googleapis';\r\nimport config from '../config';\r\n\r\nconst urlshortener = google.urlshortener('v1');\r\nconst youtube = google.youtube('v3');\r\n\r\nconst constQuery = 'Paul Simon';\r\n\r\nexport const searchList = (queryString) => {\r\n\tlet searchListPromise = new Promise((resolve, reject) => {\r\n\t\r\n\t\tyoutube.search.list({\r\n\t\t\tauth: config.services.youtube_api.apiKey,\r\n\t\t\tmaxResults: '1',\r\n\t\t\t\t\t\t\tpart: 'snippet',\r\n\t\t\t\t\t\t\tq: `${constQuery} ${queryString}`\r\n\t\t}, (err, response) => {\r\n\t\t\tif (err) {\r\n\t\t\treject('searchList error');\r\n\t\t\t} else {\r\n\t\t\tresolve(response);\r\n\t\t\t}\r\n\t\t});\r\n\t});\r\n\t\r\n\treturn searchListPromise;\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/services/youtube_api.service.js","module.exports = require(\"googleapis\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"googleapis\"\n// module id = 17\n// module chunks = 0","import * as paintSocketBindings from './paint-socket';\r\n\r\nexport function bind(io) {\r\n\r\n    paintSocketBindings.bind( io.of('/paint-socket') );\r\n\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/socket-bindings/index.js","export function bind(io) {\r\n    io.on('connection', (socket) => {\r\n        socket.on('submit', (doodleData) => {\r\n            io.emit('publish', doodleData);\r\n        });\r\n    });\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/socket-bindings/paint-socket.js"],"sourceRoot":""}