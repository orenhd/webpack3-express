{"version":3,"sources":["webpack:///webpack/bootstrap 9765050dd924fd22d4ee","webpack:///./src/config/index.js","webpack:///external \"express\"","webpack:///external \"mongoose\"","webpack:///./src/app.js","webpack:///external \"socket.io\"","webpack:///external \"body-parser\"","webpack:///external \"dotenv\"","webpack:///./src/routes/router.js","webpack:///./src/routes/user.routes.js","webpack:///./src/controllers/user.controller.js","webpack:///external \"jsonwebtoken\"","webpack:///./src/models/user.model.js","webpack:///external \"bcrypt\"","webpack:///./src/routes/chatbot.routes.js","webpack:///./src/controllers/chatbot.controller.js","webpack:///external \"request\"","webpack:///./src/services/youtube_api.service.js","webpack:///external \"googleapis\"","webpack:///./src/socket-bindings/index.js","webpack:///./src/socket-bindings/paint-socket.js"],"names":["config","app","port","process","env","PORT","mongodb","uri","MONGODB_URI","usersCollection","chatbot","verifyToken","VERIFY_TOKEN","pageAccessToken","PAGE_ACCESS_TOKEN","youtubeService","apiKey","API_KEY","socketBindings","connection","on","ref","console","log","err","connect","useMongoClient","use","urlencoded","extended","json","static","__dirname","get","req","res","sendFile","io","listen","bind","router","Router","message","user_controller","post","user_signup","user_login","user_verify_token","user_get","AT_STRING","user_temp","username","body","password","save","status","error","sendStatus","findOne","user","comparePassword","isMatch","token","sign","expiresIn","success","next","query","headers","verify","decoded","send","params","id","doc","SALT_WORK_FACTOR","userSchema","Schema","type","String","required","index","unique","pre","isModified","genSalt","salt","hash","methods","candidatePassword","cb","compare","UserModel","model","chatbot_controller","webhook","youtube_search","youTubeApiService","object","entry","forEach","messaging","event","processMessage","postback","senderId","sender","text","formattedMsg","toLowerCase","trim","fetchVideoAndSend","attachments","sendMessage","processMyPostback","payload","formattedMessage","recipientId","recipientName","searchList","then","response","items","videoData","snippet","title","thumbnails","medium","url","description","videoId","qs","access_token","method","recipient","searchListRepoonse","urlshortener","youtube","constQuery","queryString","searchListPromise","Promise","resolve","reject","search","list","auth","maxResults","part","q","paintSocketBindings","of","socket","doodleData","emit"],"mappings":"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","file":"server.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/build/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 3);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 9765050dd924fd22d4ee","import dotenv from 'dotenv';\r\n\r\ndotenv.config();\r\n\r\nconst config = {\r\n    app: {\r\n        port: process.env.PORT || 8080,\r\n    },\r\n    mongodb: {\r\n        uri: process.env.MONGODB_URI,\r\n        usersCollection: 'meadows',\r\n    },\r\n    chatbot: {\r\n        verifyToken: process.env.VERIFY_TOKEN,\r\n        pageAccessToken: process.env.PAGE_ACCESS_TOKEN,\r\n    },\r\n    youtubeService: {\r\n        apiKey: process.env.API_KEY,\r\n    }\r\n}\r\n\r\nexport default config;\n\n\n// WEBPACK FOOTER //\n// ./src/config/index.js","module.exports = require(\"express\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"express\"\n// module id = 1\n// module chunks = 0","module.exports = require(\"mongoose\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"mongoose\"\n// module id = 2\n// module chunks = 0","import mongoose from 'mongoose';\r\nimport express from 'express';\r\nimport socketIO from 'socket.io';\r\n\r\nimport bodyParser from 'body-parser';\r\n\r\nimport config from './config';\r\n;\r\nimport router from './routes/router';\r\n\r\nimport * as socketBindings from './socket-bindings';\r\n\r\n//init mongodb connection\r\nmongoose.connection.on(\"open\", function(ref) {\r\n  console.log(\"Connected to mongo server.\");\r\n});\r\n\r\nmongoose.connection.on(\"error\", function(err) {\r\n  console.log(\"Could not connect to mongo server!\", err);\r\n});\r\n\r\nmongoose.connect(config.mongodb.uri, { useMongoClient: true });\r\n\r\nconst app = express();\r\n\r\n// configure app to use bodyParser()\r\napp.use(bodyParser.urlencoded({ extended: true }));\r\napp.use(bodyParser.json());\r\n\r\n//define public directory\r\napp.use(\"/\", express.static(__dirname + '/public'));\r\n\r\n// define served pages\r\napp.get('/paint-socket', function (req, res) {\r\n  res.sendFile(__dirname + '/public/paint-socket.html');\r\n});\r\n\r\n// all of our routes will be prefixed with /api\r\napp.use('/api', router);\r\n\r\n//start server + socket\r\nconst io = socketIO.listen(app.listen(config.app.port));\r\n\r\n// init. socket bindings\r\nsocketBindings.bind(io);\r\n\r\nconsole.log(`Magic happens on port ${config.app.port}`)\r\n\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/app.js","module.exports = require(\"socket.io\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"socket.io\"\n// module id = 4\n// module chunks = 0","module.exports = require(\"body-parser\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"body-parser\"\n// module id = 5\n// module chunks = 0","module.exports = require(\"dotenv\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"dotenv\"\n// module id = 6\n// module chunks = 0","import express from 'express';\r\n\r\n// sub-routes imports\r\nimport user from './user.routes';\r\nimport chatbot from './chatbot.routes';\r\n\r\nconst router = express.Router();\r\n\r\n// test route to make sure everything is working\r\nrouter.get('/', function(req, res) {\r\n    res.json({ message: 'hooray! welcome to our api!' });   \r\n});\r\n\r\n// use sub routes\r\nrouter.use('/user', user);\r\nrouter.use('/chatbot', chatbot);\r\n\r\nexport default router;\n\n\n// WEBPACK FOOTER //\n// ./src/routes/router.js","import express from 'express';\r\n\r\nimport * as user_controller from '../controllers/user.controller';\r\n\r\nconst router = express.Router();\r\n\r\n// define routes\r\n\r\nrouter.post('/signup', user_controller.user_signup);\r\n\r\nrouter.post('/login', user_controller.user_login);\r\n\r\n// route middleware to verify a token on all following user routes\r\nrouter.use(user_controller.user_verify_token);\r\n\r\nrouter.get('/:id', user_controller.user_get);\r\n\t\r\nexport default router;\r\n\t\n\n\n// WEBPACK FOOTER //\n// ./src/routes/user.routes.js","import jwt from 'jsonwebtoken';\r\n\r\nimport { UserModel } from '../models/user.model';\r\n\r\nconst AT_STRING = 'thisisthestring';\r\n\r\nexport const user_signup = (req, res) => {\r\n\tlet user_temp = new UserModel({\r\n\t\tusername: req.body.username,\r\n\t\tpassword: req.body.password\r\n\t});\r\n\r\n\tuser_temp.save((err) => {\r\n\t\tif (err) {\r\n\t\t\tres.status(500).json({ error: \"User signup error\", ...err });\r\n\t\t} else {\r\n\t\t\tres.sendStatus(200);\r\n\t\t}\r\n\t});\r\n};\r\n\r\nexport const user_login = (req, res) => {\r\n\tUserModel.findOne({ username: req.body.username }, (err, user) => {\r\n\t\tif (err) {\r\n\t\t\tres.status(500).json({ error: \"User login error\", ...err });\r\n\t\t} else if (user) {\r\n\t\t\t// test a matching password\r\n\t\t\tuser.comparePassword(req.body.password, (err, isMatch) => {\r\n\t\t\t\tif (err) {\r\n\t\t\t\t\tres.status(401).json({ error: \"User authentication error\", ...err });\r\n\t\t\t\t} else if (isMatch) {\r\n\t\t\t\t\t// if user is found and password is right - create a token\r\n\t\t\t\t\tlet token = jwt.sign(user, AT_STRING, {\r\n\t\t\t\t\t\texpiresIn: 180\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\t// return the information including token as JSON\r\n\t\t\t\t\tres.status(200).json({\r\n\t\t\t\t\t\tsuccess: true,\r\n\t\t\t\t\t\tmessage: 'Enjoy your token!',\r\n\t\t\t\t\t\ttoken: token\r\n\t\t\t\t\t});\r\n\t\t\t\t} else {\r\n\t\t\t\t\tres.status(404).json({ success: false, message: 'Authentication failed. Wrong password.' });\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tres.status(404).json({ success: false, message: 'Authentication failed. User not found.' });\r\n\t\t}\r\n\t});\r\n};\r\n\r\n// route middleware to verify a token\r\nexport const user_verify_token = (req, res, next) => {\r\n\r\n\t// check header or url parameters or post parameters for token\r\n\tlet token = req.body.token || req.query.token || req.headers['x-access-token'];\r\n\r\n\t// decode token\r\n\tif (token) {\r\n\t\t// verifies secret and checks exp\r\n\t\tjwt.verify(token, AT_STRING, (err, decoded) => {\r\n\t\t\tif (err) {\r\n\t\t\t\treturn res.json({ success: false, message: 'Failed to authenticate token.' });\r\n\t\t\t} else {\r\n\t\t\t\t// if everything is good, save to request for use in other routes\r\n\t\t\t\treq.decoded = decoded;\r\n\t\t\t\tnext();\r\n\t\t\t}\r\n\t\t});\r\n\t} else {\r\n\t\t// if there is no token - return an error\r\n\t\treturn res.status(403).send({\r\n\t\t\tsuccess: false,\r\n\t\t\tmessage: 'No token provided.'\r\n\t\t});\r\n\t}\r\n};\r\n\r\nexport const user_get = (req, res) => {\r\n\tUserModel.findOne({ 'username': req.params.id }, (err, doc) => {\r\n\t\tif (err) {\r\n\t\t\tres.status(500).json({ error: \"Failed to get user\", ...err });\r\n\t\t} else {\r\n\t\t\tres.status(200).json({ username: doc.username });\r\n\t\t}\r\n\t});\r\n};\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/controllers/user.controller.js","module.exports = require(\"jsonwebtoken\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"jsonwebtoken\"\n// module id = 10\n// module chunks = 0","import mongoose from 'mongoose';\r\nimport bcrypt from 'bcrypt';\r\nimport config from '../config';\r\n\r\nconst SALT_WORK_FACTOR = 10;\r\n\r\nconst userSchema = new mongoose.Schema({\r\n    username: { type: String, required: true, index: { unique: true } },\r\n    password: { type: String, required: true }\r\n});\r\n\r\nuserSchema.pre('save', function(next) { // generate salt and hash before sving password prop.\r\n    var user = this;\r\n\r\n    // only hash the password if it has been modified (or is new)\r\n    if (!user.isModified('password')) return next();\r\n\r\n    // generate a salt\r\n    bcrypt.genSalt(SALT_WORK_FACTOR, function(err, salt) {\r\n        if (err) return next(err);\r\n\r\n        // hash the password along with our new salt\r\n        bcrypt.hash(user.password, salt, function(err, hash) {\r\n            if (err) return next(err);\r\n\r\n            // override the cleartext password with the hashed one\r\n            user.password = hash;\r\n            next();\r\n        });\r\n    });\r\n});\r\n\r\nuserSchema.methods.comparePassword = function(candidatePassword, cb) { // compare password method, to verify password matching\r\n    bcrypt.compare(candidatePassword, this.password, function(err, isMatch) {\r\n        if (err) return cb(err);\r\n        cb(null, isMatch);\r\n    });\r\n};\r\n\r\nexport const UserModel = mongoose.model('User', userSchema, config.mongodb.usersCollection);\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/models/user.model.js","module.exports = require(\"bcrypt\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"bcrypt\"\n// module id = 12\n// module chunks = 0","import express from 'express';\r\nimport config from '../config';\r\n\r\nimport * as chatbot_controller from '../controllers/chatbot.controller';\r\n\r\nconst router = express.Router();\r\n\r\n// define routes\r\n\r\nrouter.get('/', (req, res) => {\r\n    res.json({ message: 'hooray! welcome to our chatbot!' });   \r\n});\r\n\r\nrouter.get('/webhook', (req, res) => {\r\n\tif (req.query['hub.verify_token'] === config.chatbot.VERIFY_TOKEN) {\r\n      res.send(req.query['hub.challenge']);\r\n    } else {\r\n      res.send('Error, wrong validation token');    \r\n    } \r\n});\r\n\r\nrouter.post('/webhook', chatbot_controller.webhook);\r\n\r\n/**\r\n * YouTube API Test Routes\r\n **/\r\n \r\nrouter.get('/youtube_search', chatbot_controller.youtube_search);\r\n\t\r\nexport default router;\r\n\t\n\n\n// WEBPACK FOOTER //\n// ./src/routes/chatbot.routes.js","import request from 'request';\r\nimport config from '../config';\r\n\r\nimport * as youTubeApiService from '../services/youtube_api.service';\r\n\r\nexport const webhook = (req, res) => {\r\n\r\n\t// Make sure this is a page subscription\r\n\tif (req.body.object == \"page\") {\r\n\t\t// Iterate over each entry\r\n\t\t// There may be multiple entries if batched\r\n\t\treq.body.entry.forEach((entry) => {\r\n\t\t\t// Iterate over each messaging event\r\n\t\t\tentry.messaging.forEach((event) => {\r\n\t\t\t\tif (event.message) {\r\n\t\t\t\t\tprocessMessage(event);\r\n\t\t\t\t} else if (event.postback) {\r\n\t\t\t\t\t//TODO: process postbacks\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\r\n\t\tres.sendStatus(200);\r\n\t}\r\n}\r\n\r\n/**\r\n * Chatbot Functions\r\n **/\r\n\r\nfunction processMessage(event) {\r\n\tlet message = event.message;\r\n\tlet senderId = event.sender.id;\r\n\r\n\t// You may get a text or attachment but not both\r\n\tif (message.text) {\r\n\t\tlet formattedMsg = message.text.toLowerCase().trim();\r\n\t\tfetchVideoAndSend(formattedMsg, senderId, 'senderName');\r\n\t} else if (message.attachments) {\r\n\t\tsendMessage(senderId, { text: \"Sorry, I don't understand your request.\" });\r\n\t}\r\n}\r\n\r\nfunction processMyPostback(event) {\r\n\tlet senderId = event.sender.id;\r\n\tlet payload = event.postback.payload;\r\n}\r\n\r\nfunction fetchVideoAndSend(formattedMessage, recipientId, recipientName) {\r\n\tyouTubeApiService.searchList(formattedMessage).then((response, err) => {\r\n\t\tif (err) {\r\n\t\t\tconsole.log(\"Error searching video\", err); //TODO: handle error\r\n\t\t} else if (response && response.items[0]) {\r\n\t\t\tlet videoData = response.items[0];\r\n\t\t\tlet message = {\r\n\t\t\t\t\"attachment\": {\r\n\t\t\t\t\t\"type\": \"template\",\r\n\t\t\t\t\t\"payload\": {\r\n\t\t\t\t\t\t\"template_type\": \"generic\",\r\n\t\t\t\t\t\t\"elements\": [\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\"title\": videoData.snippet.title,\r\n\t\t\t\t\t\t\t\t\"image_url\": videoData.snippet.thumbnails.medium.url,\r\n\t\t\t\t\t\t\t\t\"subtitle\": videoData.snippet.description,\r\n\t\t\t\t\t\t\t\t\"default_action\": {\r\n\t\t\t\t\t\t\t\t\t\"type\": \"web_url\",\r\n\t\t\t\t\t\t\t\t\t\"url\": `https://www.youtube.com/watch?v=${videoData.id.videoId}`,\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t]\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tsendMessage(recipientId, message)\r\n\t\t}\r\n\t})\r\n}\r\n\r\n// sends message to user\r\nfunction sendMessage(recipientId, message) {\r\n\trequest({\r\n\t\turl: \"https://graph.facebook.com/v2.10/me/messages\",\r\n\t\tqs: { access_token: config.chatbot.pageAccessToken },\r\n\t\tmethod: \"POST\",\r\n\t\tjson: {\r\n\t\t\trecipient: { id: recipientId },\r\n\t\t\tmessage: message,\r\n\t\t}\r\n\t}, function (error, response, body) {\r\n\t\tif (error) {\r\n\t\t\tconsole.log(\"Error sending message\", error);\r\n\t\t} else {\r\n\t\t\tconsole.log(response);\r\n\t\t}\r\n\t});\r\n}\r\n\r\n/**\r\n * YouTube API Test functions\r\n **/\r\n\r\nexport const youtube_search = (req, res) => {\r\n\tyouTubeApiService.searchList(req.query['query_string']).then((searchListRepoonse, err) => {\r\n\t\tif (err) {\r\n\t\t\tres.status(500).json({ ...err, error: \"searchList Error\" });\r\n\t\t} else {\r\n\t\t\tres.status(200).json(searchListRepoonse);\r\n\t\t}\r\n\t})\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/controllers/chatbot.controller.js","module.exports = require(\"request\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"request\"\n// module id = 15\n// module chunks = 0","import google from 'googleapis';\r\nimport config from '../config';\r\n\r\nconst urlshortener = google.urlshortener('v1');\r\nconst youtube = google.youtube('v3');\r\n\r\nconst constQuery = 'Paul Simon';\r\n\r\nexport const searchList = (queryString) => {\r\n\tlet searchListPromise = new Promise((resolve, reject) => {\r\n\t\r\n\t\tyoutube.search.list({\r\n\t\t\tauth: config.youtubeService.apiKey,\r\n\t\t\tmaxResults: '1',\r\n\t\t\t\t\t\t\tpart: 'snippet',\r\n\t\t\t\t\t\t\tq: `${constQuery} ${queryString}`\r\n\t\t}, (err, response) => {\r\n\t\t\tif (err) {\r\n\t\t\treject('searchList error');\r\n\t\t\t} else {\r\n\t\t\tresolve(response);\r\n\t\t\t}\r\n\t\t});\r\n\t});\r\n\t\r\n\treturn searchListPromise;\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/services/youtube_api.service.js","module.exports = require(\"googleapis\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"googleapis\"\n// module id = 17\n// module chunks = 0","import * as paintSocketBindings from './paint-socket';\r\n\r\nexport function bind(io) {\r\n\r\n    paintSocketBindings.bind( io.of('/paint-socket') );\r\n\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/socket-bindings/index.js","export function bind(io) {\r\n    io.on('connection', (socket) => {\r\n        socket.on('submit', (doodleData) => {\r\n            io.emit('publish', doodleData);\r\n        });\r\n    });\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/socket-bindings/paint-socket.js"],"sourceRoot":""}